@model Blog.Models.BlogPost

@{
    ViewBag.Title = "Details";
}


<!-- ==============================================
     SINGLE POST
=============================================== -->
<section id="blog" class="big-padding">

    <div class="container">

        <div class="row">

            <!-- Blog Post Content Column -->
        <div id="start"></div>
            <div class="col-lg-8">

                <!-- Blog Post -->
                <!-- Title -->
                <h1>@Html.DisplayFor(model => model.Title)</h1>
            
                <!-- Author -->
                <p class="lead">
                    by <a href="#">Ray Goodwin</a>
                </p>

                <hr>

                <!-- Date/Time -->
                <p><span class="glyphicon glyphicon-time"></span> Posted on @Html.DisplayFor(model => model.Created)</p>

                <hr>

                <!-- Post Image -->

                <div>
                    @if (@Model.MediaURL != null)
                    {
                        <img class="img-responsive" src="@Model.MediaURL" alt="" />
                    }
                </div>
            
                <!-- Post Content -->

                <p>@Html.Raw(Model.Body)</p>

                <hr />

                <!-- Blog Comments -->
                <!-- Comments Form -->
                
                @if (User.Identity.IsAuthenticated)
                {

                    <form id="contactForm" method="post" action="@Url.Action("CreateComment", "BlogPosts")">
                        @Html.AntiForgeryToken()
                        <h3>Leave a Comment</h3>
                        <input type="hidden" name="PostId" value="@Model.Id" />
                        <div class="form-group">
                            <div>

                                <textarea name="Body" class="form-control" rows="6"></textarea>
                            </div>
                        </div><!-- End Comment Box -->

                        <input type="submit" value="Submit" class="btn btn-default" /><br />

                    </form>
                <!-- End Comment Form -->


                }
                else
                {
                    <h4>Please <a href="@Url.Action("Login","Account")">Login</a> to Post a Comment</h4>
                }
            
                

                <hr />

                <!-- Posted Comments -->
                      

                    @foreach (var item in Model.Comments.OrderByDescending(c => c.Created))
                    {
                        <div>
                            <h4>@Html.DisplayFor(modelItem => item.Author.UserName)</h4>
                            <p>@Html.DisplayFor(modelItem => item.Created)</p>

                            <div class="well">
                                <p>@Html.Raw( item.Body)</p>
                            </div><!-- End Comment Body -->

                            <br />

                            @if (HttpContext.Current.User.IsInRole("Moderator") || (HttpContext.Current.User.IsInRole("Admin")))
                            {
                                <a href="@Url.Action("Edit", "Comment", new { id= item.Id})">Edit</a>
                                <a href="@Url.Action("Delete", "Comment", new {id= item.Id})">Delete</a>
                            }
                            


                            <br />

                            <hr />

                        </div>
                    }

                
                    <!-- Comment -->

                </div><!-- End Post Content Column -->

            <!-- Blog Sidebar Widgets Column -->

            <div class="col-lg-4">

                <!-- Blog Search Well -->

                <div class="well">

                </div><!-- End Blog Search Well -->

                <!-- Blog Categories Well -->

                <div class="well">

                </div><!-- End Blog Categories Well -->

            </div><!-- End Sidebar Widget Column -->



        </div><!-- End Row -->
        
        <br />
        
        <hr />
            
        <p>
           @Html.ActionLink("Back to List", "Index")
        </p>

    </div><!--  End Container -->

</section><!--  End Section -->




